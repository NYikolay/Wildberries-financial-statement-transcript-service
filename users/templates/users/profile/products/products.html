{% extends 'base.html' %}
{% load static %}
{% block title %} Подписка - Commery{% endblock %}
{% block styles %}
<link rel="stylesheet" href="{% static 'users/css/products.css' %}">
<link rel="stylesheet" href="{% static 'css/common_form.css' %}">
<link rel="stylesheet" href="{% static 'css/common_load.css' %}">
{% endblock %}
{% block content %}
<div class="products-wrapper">
    <div class="common__content-wrapper product__detail-wrapper">
        <div class="product__detail-head">
            <h1>Себестоимость товаров</h1>
        </div>
        {% include 'users/profile/products/includes/load_file_form.html' %}
        <div class="product__detail-subheader">
            <button type="button" id='open-file-form' data-hide-type="opacity" class="load_costs-button">
                <svg width="13" height="13" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M5.117 2.31219L5.10827 2.30725L4.62459 2.59147L4.13652 2.8683V2.87828L2.52536 2.21334C2.21339 2.08458 1.85428 2.20672 1.68553 2.499L0.246483 4.99152C0.0785296 5.28242 0.150732 5.65263 0.415697 5.85909L1.79497 6.93386L1.78631 8.06105L1.79672 8.06705L0.416338 9.14069C0.151014 9.34706 0.0785762 9.71751 0.24663 10.0086L1.68508 12.5003C1.85392 12.7928 2.21334 12.9149 2.52541 12.7858L4.13881 12.1184L4.63083 12.3974L5.1185 12.684L5.35858 14.4191C5.40464 14.752 5.68927 15 6.02539 15H8.9025C9.24022 15 9.52566 14.7498 9.56987 14.415L9.7985 12.684L10.2861 12.3974L10.778 12.1185L12.4006 12.7781C12.712 12.9047 13.069 12.7822 13.2371 12.4911L14.6757 9.99942C14.8445 9.70695 14.7705 9.33464 14.5027 9.12895L13.1203 8.06725L13.1306 8.06128L13.122 6.93411L14.5035 5.87144C14.771 5.66566 14.8448 5.29359 14.676 5.0013L13.2371 2.50873C13.0691 2.21781 12.7124 2.09523 12.4011 2.22145L10.7807 2.87847L10.7804 2.87831V2.8683L10.2925 2.59156L9.80889 2.30736L9.80022 2.31236L9.79992 2.31219L9.5703 0.584478C9.52583 0.24992 9.24048 0 8.90298 0H6.02488C5.68897 0 5.40447 0.247633 5.35814 0.580333L5.117 2.31219ZM7.45847 4.97561C6.06833 4.97561 4.94139 6.10255 4.94139 7.49269C4.94139 8.88283 6.06833 10.0098 7.45847 10.0098C8.84861 10.0098 9.97553 8.88283 9.97553 7.49269C9.97553 6.10255 8.84861 4.97561 7.45847 4.97561Z" fill="#00C6FF"/>
                </svg>
                Загрузить себестоимость файлом
            </button>
            <div class="product__detail-costs__head">
                <p class="text__common-bold">Себестоимость</p>
                <p class="text__common-bold">Дата начала действия</p>
            </div>
        </div>
        <div class="products-wrapper">
            <div class="products-container">
                {% for p in products %}
                <a href="{% url 'users:product_detail' p.nm_id %}?page={{ products.number }}">
                    <div class="product__item {% if p.nm_id == product.nm_id %}product__item-active{% endif %}">
                        {% if p.image %}
                        <img class="product-image" src="{{ p.image }}" alt="Артикул {{ p.nm_id }}">
                        {% else %}
                        <div class="empty__product-image__wrapper">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect width="40" height="40" fill="#32396B"/>
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.591 10.2286C10.8958 9.92379 11.3901 9.92379 11.6949 10.2286L12.9415 11.4752C12.9885 11.4731 13.0358 11.472 13.0833 11.472H26.8996C28.6024 11.472 29.9829 12.8524 29.9829 14.5553V25.3663C29.9829 26.2348 29.6238 27.0194 29.046 27.5798L29.7714 28.3051C30.0762 28.61 30.0762 29.1042 29.7714 29.409C29.4665 29.7139 28.9723 29.7139 28.6675 29.409L27.6228 28.3643C27.3908 28.4201 27.1486 28.4496 26.8996 28.4496H13.0833C11.3804 28.4496 10 27.0692 10 25.3663V14.5553C10 13.5174 10.5128 12.5993 11.2989 12.0405L10.591 11.3325C10.2861 11.0277 10.2861 10.5335 10.591 10.2286ZM11.5612 14.5553C11.5612 13.9462 11.9189 13.4207 12.4358 13.1774L15.0054 15.747C14.3402 15.9837 13.8639 16.6189 13.8639 17.3654C13.8639 18.3138 14.6327 19.0827 15.5812 19.0827C16.3276 19.0827 16.9629 18.6064 17.1995 17.9411L20.2503 20.9918L18.5083 23.2978L17.2303 21.7137C16.4315 20.7238 14.952 20.6416 14.0485 21.537L11.5612 24.0024V14.5553ZM14.4994 13.0332L27.9419 26.4756C28.2372 26.198 28.4217 25.8037 28.4217 25.3663V24.9747L22.2551 18.7704L22.7235 18.5363L23.3674 18.3997L23.8943 18.3411L24.5578 18.4582L25.1237 18.7119L25.5921 19.0632L26.0604 19.5705L28.4217 22.4754V14.5553C28.4217 13.7147 27.7402 13.0332 26.8996 13.0332H14.4994Z" fill="#5C659D"/>
                            </svg>
                        </div>
                        {% endif %}
                        <div class="product__item-description">
                            <div class="product__item-description__inner">
                                <p class="text__accent-bold">{{ p.product_name }}</p>
                                <p class="text__accent">Артикул: {{ p.nm_id }}</p>
                            </div>
                            {% if not p.has_net_cost %}
                            <div class="product__item-status">
                                <svg width="7" height="7" viewBox="0 0 7 7" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect class="error__dot-icon" width="7" height="7" rx="3.5"/>
                                </svg>
                                <p class="text__accent-bold">Не добавлена</p>
                            </div>
                            {% else %}
                            <div class="product__item-status">
                                <svg width="7" height="7" viewBox="0 0 7 7" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect class="success__dot-icon" width="7" height="7" rx="3.5"/>
                                </svg>
                                <p class="text__accent-bold">Добавлена</p>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </a>
                {% endfor %}
                <div class="products__pagination-wrapper">
                    <div class="products__pages-container">
                        <p class="text__common-bold">Страница</p>
                        <input
                                class="paginator_input"
                                type="number"
                                data-place="{{ products.paginator.num_pages }}"
                                value="{{ products.number }}"
                                onclick="generateInputValidationForPaginator()">
                        <p class="text__common-bold">из {{ products.paginator.num_pages }}</p>
                    </div>
                    <div>
                        {% if products.has_previous %}
                        <a href="?page={{ products.previous_page_number }}" class="arrow_item">
                            <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M1.26 0C0.564121 0 0 0.564121 0 1.26V19.74C0 20.4359 0.564121 21 1.26 21H19.74C20.4359 21 21 20.4359 21 19.74V1.26C21 0.564121 20.4359 0 19.74 0H1.26ZM13.2459 17.7638C13.5887 18.1043 14.1426 18.1025 14.4832 17.7597C14.8237 17.4169 14.8218 16.863 14.479 16.5224L8.41628 10.5L14.479 4.47757C14.8218 4.13704 14.8237 3.5831 14.4832 3.24032C14.1426 2.89752 13.5887 2.89566 13.2459 3.23619L6.55832 9.8793C6.39297 10.0435 6.3 10.267 6.3 10.5C6.3 10.733 6.39297 10.9564 6.55832 11.1207L13.2459 17.7638Z" fill="#5C659D"/>
                            </svg>
                        </a>
                        {% else %}
                        <a href="" class="arrow_item disabled_arrow">
                            <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M1.26 0C0.564121 0 0 0.564121 0 1.26V19.74C0 20.4359 0.564121 21 1.26 21H19.74C20.4359 21 21 20.4359 21 19.74V1.26C21 0.564121 20.4359 0 19.74 0H1.26ZM13.2459 17.7638C13.5887 18.1043 14.1426 18.1025 14.4832 17.7597C14.8237 17.4169 14.8218 16.863 14.479 16.5224L8.41628 10.5L14.479 4.47757C14.8218 4.13704 14.8237 3.5831 14.4832 3.24032C14.1426 2.89752 13.5887 2.89566 13.2459 3.23619L6.55832 9.8793C6.39297 10.0435 6.3 10.267 6.3 10.5C6.3 10.733 6.39297 10.9564 6.55832 11.1207L13.2459 17.7638Z" fill="#5C659D"/>
                            </svg>
                        </a>
                        {% endif %}
                        {% if products.has_next %}
                        <a href="?page={{ products.next_page_number }}" class="arrow_item">
                            <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M1.26 0C0.564121 0 0 0.564121 0 1.26V19.74C0 20.4359 0.564121 21 1.26 21H19.74C20.4359 21 21 20.4359 21 19.74V1.26C21 0.564121 20.4359 0 19.74 0H1.26ZM7.79144 3.23619C7.44863 2.89566 6.89469 2.89752 6.55419 3.24032C6.21366 3.5831 6.21552 4.13704 6.55832 4.47757L12.6211 10.5L6.55832 16.5224C6.21552 16.863 6.21366 17.4169 6.55419 17.7597C6.89469 18.1025 7.44863 18.1043 7.79144 17.7638L14.479 11.1207C14.6444 10.9565 14.7373 10.733 14.7373 10.5C14.7373 10.267 14.6444 10.0436 14.479 9.87932L7.79144 3.23619Z" fill="#5C659D"/>
                            </svg>
                        </a>
                        {% else %}
                        <a href="" class="arrow_item disabled_arrow">
                            <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M1.26 0C0.564121 0 0 0.564121 0 1.26V19.74C0 20.4359 0.564121 21 1.26 21H19.74C20.4359 21 21 20.4359 21 19.74V1.26C21 0.564121 20.4359 0 19.74 0H1.26ZM7.79144 3.23619C7.44863 2.89566 6.89469 2.89752 6.55419 3.24032C6.21366 3.5831 6.21552 4.13704 6.55832 4.47757L12.6211 10.5L6.55832 16.5224C6.21552 16.863 6.21366 17.4169 6.55419 17.7597C6.89469 18.1025 7.44863 18.1043 7.79144 17.7638L14.479 11.1207C14.6444 10.9565 14.7373 10.733 14.7373 10.5C14.7373 10.267 14.6444 10.0436 14.479 9.87932L7.79144 3.23619Z" fill="#5C659D"/>
                            </svg>
                        </a>
                        {% endif %}

                    </div>
                </div>
            </div>
            <div class="product__net-costs__wrapper">
                {% for net_cost in net_costs %}
                <div class="product__net-cost__item">
                    <div class="product__net-cost__description">
                        <p class="text__accent">{{ net_cost.object.amount|floatformat:"-2g" }}</p>
                        <p class="text__accent">{{ net_cost.object.cost_date|date:"d.m.Y" }}</p>
                    </div>
                    <button id="open-update-form" data-net-cost-id="{{ net_cost.object.id }}">
                        <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M0.991238 10.3348C0.991238 9.9599 1.14031 9.60042 1.40561 9.33553L7.96066 2.79049L10.2265 5.03627L5.22615 10.0101C5.03211 10.2032 5.03131 10.5169 5.22438 10.7109C5.41743 10.9049 5.73124 10.9057 5.92528 10.7127L12.5618 4.11122C13.1416 3.53455 13.1467 2.59806 12.5733 2.01512L11.0281 0.444228C10.4492 -0.144331 9.50151 -0.148606 8.91731 0.434706L0.705155 8.63432C0.253684 9.08509 2.22966e-07 9.69684 2.03099e-07 10.3348L0 12.232C-9.06287e-08 12.6561 0.343939 13 0.768209 13H2.51677C3.04211 13 3.55298 12.8279 3.97124 12.5101L4.38875 12.1929C4.60667 12.0273 4.64907 11.7164 4.48346 11.4986C4.31783 11.2807 4.0069 11.2383 3.78897 11.4039L3.37146 11.7211C3.12567 11.9079 2.82547 12.009 2.51677 12.009H0.991238V10.3348ZM10.9292 4.33729L11.8627 3.40868C12.056 3.21646 12.0576 2.90429 11.8665 2.70999L10.3214 1.1391C10.1284 0.942909 9.8125 0.941483 9.61777 1.13592L8.66204 2.09018L10.9292 4.33729ZM5.89784 12.4426C5.89784 12.1689 6.11974 11.9471 6.39345 11.9471H12.2665C12.5403 11.9471 12.7622 12.1689 12.7622 12.4426C12.7622 12.7163 12.5403 12.9381 12.2665 12.9381H6.39345C6.11974 12.9381 5.89784 12.7163 5.89784 12.4426Z" fill="#00C6FF"/>
                        </svg>
                    </button>
                </div>

                {% include 'users/profile/products/includes/update_net_cost_form.html' %}

                {% endfor %}
                <button class="add__net-cost_button" id="open-create-form">
                    <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M6.5 0C6.21954 0 5.99219 0.227355 5.99219 0.507812V5.99219H0.507812C0.227356 5.99219 0 6.21954 0 6.5C0 6.78046 0.227356 7.00781 0.507812 7.00781H5.99219V12.4922C5.99219 12.7726 6.21954 13 6.5 13C6.78046 13 7.00781 12.7726 7.00781 12.4922V7.00781H12.4922C12.7726 7.00781 13 6.78046 13 6.5C13 6.21954 12.7726 5.99219 12.4922 5.99219H7.00781V0.507812C7.00781 0.227355 6.78046 0 6.5 0Z" fill="#00C6FF"/>
                    </svg>
                    <p class="text__common-normal" style="color: var(--var-blue-accent-color)">Добавить</p>
                </button>

                {% include 'users/profile/products/includes/create_net_cost_form.html' %}
            </div>
        </div>
    </div>
</div>

<script src="{% static 'users/js/products/products.js' %}"></script>
<script src="{% static 'js/handleInputsValidation.js' %}"></script>
<script src="{% static 'js/loadFile.js' %}"></script>
<script src="{% static 'users/js/products/netCostForm.js' %}"></script>
{% endblock %}