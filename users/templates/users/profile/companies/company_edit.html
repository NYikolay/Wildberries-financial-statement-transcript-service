{% extends 'base.html' %}
{% load static %}
{% block title %}Изменение магазина - Commery{% endblock %}
{% block content %}
<div class="container">
    <div class="company_main-wrapper">
        <div class="account_header-wrapper">
            <div class="account_nav-menu">
                <ul class="account_nav-list">
                    <li class="account_nav-item">
                        <a href="{% url 'users:profile' %}" class="account_nav-link">
                            Аккаунт
                        </a>
                    </li>
                    <li class="account_nav-item">
                        <a href="{% url 'users:companies_list' %}" class="account_nav-link nav_link-active">
                            Магазин
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="company_edit-wrapper">
            <div class="company_edit-item">
                <form action="{% url 'users:company_edit' company.id %}" method="post" class="company_edit-form">
                    {% csrf_token %}
                    <div class="company-edit-body">
                        <div class="company_edit-top">
                            <div class="company_edit-name">
                                <input
                                        class="shop_name-input {% if api_key_form.name.errors %}invalid_input{% endif %}"
                                        type="text"
                                        value="{{api_key_form.name.value|default_if_none:''}}"
                                        name="{{api_key_form.name.html_name}}"
                                        maxlength="65"
                                        required=""
                                        id="{{api_key_form.name.id_for_label}}"
                                >
                                <div class="middle_info-items">
                                    <label for="{{api_key_form.name.id_for_label}}">Название магазина</label>
                                    {{ api_key_form.name.errors }}
                                </div>
                            </div>
                            <div class="company_edit-key">
                                <textarea
                                        name="{{api_key_form.api_key.html_name}}"
                                        cols="3"
                                        rows="2"
                                        class="api_key-input {% if api_key_form.api_key.errors %}invalid_input{% endif %}"
                                        maxlength="655"
                                        id="{{api_key_form.api_key.id_for_label}}"
                                >{{ api_key_form.api_key.value }}</textarea>
                                <div class="middle_info-items">
                                    <label for="{{api_key_form.api_key.id_for_label}}">Api ключ. <a href="https://seller.wildberries.ru/supplier-settings/access-to-new-api" target="_blank" style="color: #ff8364">создать ключ статистики</a></label>
                                    {{ api_key_form.api_key.errors }}
                                    <a href="https://commery.ru/where-key" target="_blank">где взять ключ?</a>
                                </div>
                            </div>
                        </div>
                        <div class="company_edit-middle">
                            <h1 class="footer_title">Налоги</h1>
                            <div class="help_info-wrapper">
                                <img src="{% static 'images/attention (2).svg' %}" alt="">
                                <p>укажите ставку налога и она будет учтена при расчете прибыли от продаж</p>
                            </div>
                        </div>
                        <div class="company_edit-footer">
                            {% if taxes %}
                            {% for tax in taxes %}
                            <div class="tax_inputs-item" id="tax_input">
                                <div class="input-item">
                                    <input type="number" step="any" id="tax_rate" min="0" placeholder="%" value="{{ tax.tax_rate|floatformat:0 }}" name="tax_rate" style="width: 90px;">
                                    <label for="tax_rate">Ставка налога</label>
                                </div>
                                <div class="input-item">
                                    <input type="date" value="{{ tax.commencement_date|date:'Y-m-d' }}" id="commencement_date" name="commencement_date">
                                    <label for="commencement_date">Дата начала действия ставки</label>
                                </div>
                            </div>
                            {% endfor %}
                            {% else %}
                            <div class="tax_inputs-item" id="tax_input">
                                <div class="input-item">
                                    <input type="number" id="tax_rate" min="0" placeholder="%" name="tax_rate" style="width: 90px;">
                                    <label for="tax_rate">Ставка налога</label>
                                </div>
                                <div class="input-item">
                                    <input type="date" value="" id="commencement_date" name="commencement_date">
                                    <label for="commencement_date">Дата начала действия ставки</label>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        <button type="button" class="add_tax-button" id="add_tax">Добавить ставку</button>
                    </div>
            </div>
            <div class="company_edit-buttons">
                <a href="{% url 'users:companies_list' %}" class="cancel_link">Отменить</a>
                <button class="send_form-button" type="submit">Сохранить</button>
            </div>
            </form>
        </div>
    </div>
</div>

<script src="{% static 'users/js/profile.js' %}"></script>
{% endblock %}